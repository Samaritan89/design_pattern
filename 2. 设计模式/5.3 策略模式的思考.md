# 策略模式的思考

## 多态在策略模式中的体现

通过使用策略模式重构代码，我们消除了程序中大片的天剑分支语句，所有和计算奖金有关的逻辑不再放在Context中，而是分布在哥哥策略对象中。Context并没有计算奖金的能力，而是把这个职责委托给了某个策略对象，每个策略对象负责的算法已被各自封装在对象内部。

当我们对策略对象发出*计算奖金*的请求时，它们会返回各自不同的计算结果，这正是对象多态性的体现，也是“它们可以互相替换”的目的。替换Context中当前保存的策略对象，便能执行不同的算法，来得到我们想要的结果。

## 策略模式的优缺点

策略模式是一种常用且有效的设计模式，有几个明显的优点

1. 策略模式李勇组合、委托、多态等技术和思想，可以有效的避免多重条件选择语句
2. 策略模式提供了对*开放-封闭*原则的支持，将算法封装在独立的strategy中，使得它们方便切换、理解、拓展
3. 策略模式的算法可以复用在系统其它地方
4. 策略模式李勇组合和委托来让Context拥有执行算法的能力，这也是继承的一种更轻便的替代方案

当然策略模式也有缺点

1. 使用策略模式会在程序中增加很多策略类或者策略对象
2. 要使用策略类，必须向客户端暴露所有实现，违反最小知识原则

## 一等函数对象与策略模式

在以类为中心的传统面向对象语言中，不同的算法或行为被封装在各个策略类中，Context将请求委托给这些策略对象，这些策略对象会根据请求返回不同的执行结果，这样能表现出对象的多态性

但在函数作为一等对象的语言中，策略模式是隐形的，strategy就是值为函数的变量。在JavaScript中除了使用类来封装算法和行为外，使用函数当然也是一种选择，这些算法可以封装到函数中并且四处传播，也就是我们常说的“高阶函数”。

实际上在JavaScript这种将函数作为一等对象的语言里，策略模式已经融入到了语言本身当中，我们经常用高阶函数来封装不同的行为，并且把它传递到另一个函数中。当我们对这些函数发出*调用*的消息时，不同的函数会返回不同的结果。在JavaScript中“函数对象的多态性”来的更加简单。

    var S = function(salary){
        return salary * 4;
    };

    var A = function(salary){
        return salary * 3;
    };

    var B = function(salary){
        return salary * 2;
    };

     var calculateBonus = function(func, salary){
        return func(salary);
    };

    console.log(calculateBonus(S, 20000));

