# 封装

封装的目的是将信息隐藏，一般有四种

1. 封装shuju

2. 封装实现

3. 封装类型

4. 封装变化

## 封装数据

在许多语言的对象系统中，封装数据是由语法解析来实现的，这些语言也许提供了`private`、`public`、`protected`等关键字来提供不同的访问权限。

但JavaScript并没有提供对这些关键字的支持，我们只能依赖变量的作用域来实现封装特性，而且只恩呢该模拟出`public`和`private`这两种封装性。

除了ES6中提供的`let`之外，一般我们通过函数来创建作用域

    var myObj = (function(){
        var __name = 'sven'; // 私有(private)变量
        return {
            getName: function(){ // 公有(public)方法
                return __name;
            }
        };
    })();

    console.log(myObj.getName()); // sven
    console.log(myObj.__name); // undefined

## 封装实现

有时候我们喜欢把封装等同于数据封装，但这是狭义的定义，封装的目的是将信息隐藏，封装应该被视为*任何形式的封装*，也就是说封装不仅仅是隐藏数据，还包括隐藏实现细节、设计细节以及隐藏对象的类型等。

从封装实现细节来讲，封装是的对象内部的变化对其它对象时透明的，对象对它自己行为负责，其它对象或用户都不关系它的内部实现。封装是的对象之间的耦合变松散，对象之间只通过暴露API来通信。我们可以随意修改对象的内部实现，只要对外的借口没有变化，就不会影响到程序的其它功能。

封装实现细节的例子非常多，拿迭代器来讲，迭代器的作用是在不暴露一个聚合对象内部表示的前提下，提供一种方式来顺序访问这个聚合对象。我们编写一个`each`函数，它的作用就是便利一个聚合对象，使用这个`each`函数的人不用关心它的内部是怎么实现的，只要提供的功能正确就可以。即使`each`函数修改了内部源代码，只要对外的接口或者调用方式没有变化，用户就不用关心它的内部实现的改变。

## 封装类型

静态类型是静态语言中一种非常重要的封装方式，一般而言封装类型是通过接口和抽象类进行的。把对象的真正类型隐藏在抽象类或者接口之后，相比对象的类型，客户更关心的是对象的行为。在许多静态语言的设计模式中，想方设法去隐藏对象的类型，也是促使这些模式诞生的原因之一，比如工厂模式、组合模式等。

当然在JavaScript中并没有对抽象类和接口的支持，JavaScript也是一种类型模糊的语言。在封装类型方面JavaScript没有能力，也没有必要做的更多。对于JavaScript的设计模式来说，不区分类型是一种失色，也可以说是一种解脱。

## 封装变化

从设计模式的角度出发，封装更重要的层面体现为*封装变化*

> 考虑你的设计中哪些地方可能发生变化，这种方式与关注会导致重新设计的原因相反。它不是考虑什么时候破迫使你的设计改变，而是考虑你怎样才能够在不重新设计的情况下进行改变。这里的关键在于封装发生变化的概念，这是很多设计模式的主题。 —— 《设计模式》

《设计模式》中归纳的23中设计模式，从意图上区分有三类

1. 创建型模式
2. 结构型模式
3. 行为型模式

拿创建型模式来说，要创建一个对象是一种抽象行为，而具体创建什么对象时可变化的，创建型模式的目的就是封装创建对象的变化。而结构型模式封装的是对象之间的组合关系，行为型模式封装的是对象的行为变化。

通过封装变化的方式，把系统中稳定不变的部分和容易变化的部分隔离开来，在系统的演变过程中，我们只需要替换那些容易变化的部分，如果这些部分是已经封装好的，替换起来也相对容易。这可以最大程度的保证程序的稳定性和可拓展性。
